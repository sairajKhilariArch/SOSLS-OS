<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      Wireplumber-0.5.10
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL-NS Stylesheets Vsnapshot" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="blfs" id="blfs-12.4">
    <div class="navheader">
      <h4>
        Beyond Linux<sup>®</sup> From Scratch <span class="phrase">(System
        V</span> Edition) - Version 12.4
      </h4>
      <h3>
        Chapter&nbsp;42.&nbsp;Multimedia Libraries and Drivers
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="v4l-utils.html" title=
          "v4l-utils-1.30.1">Prev</a>
          <p>
            v4l-utils-1.30.1
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="x264.html" title="x264-20250815">Next</a>
          <p>
            x264-20250815
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="libdriv.html" title=
          "Chapter&nbsp;42.&nbsp;Multimedia Libraries and Drivers">Up</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Beyond Linux® From Scratch    (System V Edition) - Version 12.4">Home</a>
        </li>
      </ul>
    </div>
    <h1 class="sect1">
      <a id="wireplumber" name="wireplumber"></a>Wireplumber-0.5.10
    </h1>
    <div class="sect1" lang="en" xml:lang="en">
      <div class="package" lang="en" xml:lang="en">
        <h2 class="sect2">
          Introduction to Wireplumber
        </h2>
        <p>
          The <span class="application">Wireplumber</span> package contains a
          session and policy manager for <span class=
          "application">Pipewire</span>.
        </p>
        <p>
          This package is known to build and work properly using an LFS 12.4
          platform.
        </p>
        <h3>
          Package Information
        </h3>
        <div class="itemizedlist">
          <ul class="compact">
            <li class="listitem">
              <p>
                Download (HTTP): <a class="ulink" href=
                "https://gitlab.freedesktop.org/pipewire/wireplumber/-/archive/0.5.10/wireplumber-0.5.10.tar.bz2">
                https://gitlab.freedesktop.org/pipewire/wireplumber/-/archive/0.5.10/wireplumber-0.5.10.tar.bz2</a>
              </p>
            </li>
            <li class="listitem">
              <p>
                Download MD5 sum: 2cbb662f91da2bdce31fa55bef5dfcf5
              </p>
            </li>
            <li class="listitem">
              <p>
                Download size: 416 KB
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimated disk space required: 89 MB (with tests)
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimated build time: 0.3 SBU (with tests)
              </p>
            </li>
          </ul>
        </div>
        <h3>
          Wireplumber Dependencies
        </h3>
        <h4>
          Required
        </h4>
        <p class="required">
          <span class="phrase"><a class="xref" href="../general/elogind.html"
          title="elogind-255.17">elogind-255.17</a>,</span> <a class="xref"
          href="../general/glib2.html" title="GLib-2.84.4">GLib-2.84.4</a>,
          <span class="phrase">and</span> <a class="xref" href=
          "pipewire.html" title="Pipewire-1.4.7">pipewire-1.4.7</a>
        </p>
        <h4>
          Recommended
        </h4>
        <p class="recommended">
          <a class="xref" href="../general/lua.html" title=
          "Lua-5.4.8">Lua-5.4.8</a>
        </p>
        <h4>
          Optional
        </h4>
        <p class="optional">
          <a class="xref" href="../general/doxygen.html" title=
          "Doxygen-1.14.0">Doxygen-1.14.0</a>, <a class="xref" href=
          "../general/python-modules.html#lxml" title=
          "lxml-6.0.0">lxml-6.0.0</a>, <a class="xref" href=
          "../general/python-modules.html#sphinx" title=
          "Sphinx-8.2.3">sphinx-8.2.3</a>, <a class="xref" href=
          "../general/python-modules.html#sphinx_rtd_theme" title=
          "Sphinx_rtd_theme-3.0.2">sphinx_rtd_theme-3.0.2</a>, and <a class=
          "ulink" href="https://pypi.org/project/breathe/">Breathe</a>
        </p>
      </div>
      <div class="installation" lang="en" xml:lang="en">
        <h2 class="sect2">
          Installation of Wireplumber
        </h2>
        <p>
          Install <span class="application">Wireplumber</span> by running the
          following commands:
        </p>
        <pre class="userinput"><kbd class="command">mkdir build &amp;&amp;
cd    build &amp;&amp;

meson setup --prefix=/usr --buildtype=release -D system-lua=true .. &amp;&amp;
ninja</kbd></pre>
        <p>
          To test the results, issue: <span class="command"><strong>ninja
          test</strong></span>.
        </p>
        <p>
          Now, as the <code class="systemitem">root</code> user:
        </p>
        <pre class="root"><kbd class="command">ninja install</kbd></pre>
        <p>
          Finally, rename the documentation directory to a versioned
          directory as the <code class="systemitem">root</code> user:
        </p>
        <pre class="root"><kbd class=
        "command">mv -v /usr/share/doc/wireplumber{,-0.5.10}</kbd></pre>
      </div>
      <div class="commands" lang="en" xml:lang="en">
        <h2 class="sect2">
          Command Explanations
        </h2>
        <p>
          <em class="parameter"><code>--buildtype=release</code></em>:
          Specify a buildtype suitable for stable releases of the package, as
          the default may produce unoptimized binaries.
        </p>
        <p>
          <em class="parameter"><code>-D system-lua=true</code></em>: This
          switch enables using the system version of Lua. Omit this switch if
          you have not installed Lua, but note that <span class=
          "application">meson</span> will download and install it's own
          version.
        </p>
      </div>
      <div class="configuration" lang="en" xml:lang="en">
        <h2 class="sect2">
          Configuring Wireplumber
        </h2>
        <div class="sect3" lang="en" xml:lang="en">
          <h3 class="sect3">
            Configuration Information
          </h3>
          <p>
            In order for Wireplumber to be used by Pipewire, Wireplumber and
            Pipewire must be configured to start when a desktop environment
            is started.
          </p>
          <p>
            Pipewire now provides it's own Pulseaudio server implementation,
            which causes runtime conflicts with the server provided by
            Pulseaudio itself. This generally presents itself by applications
            hanging or malfunctioning when trying to play or record audio and
            video. First, prevent Pulseaudio from starting it's own server
            implementation by running the following commands as the
            <code class="systemitem">root</code> user:
          </p>
          <pre class="root"><kbd class=
          "command">rm -vf /etc/xdg/autostart/pulseaudio.desktop         &amp;&amp;
rm -vf /etc/xdg/Xwayland-session.d/00-pulseaudio-x11 &amp;&amp;
sed -e '$a autospawn = no' -i /etc/pulse/client.conf</kbd></pre>
          <p>
            Next, create a shell script that will start Wireplumber and
            Pipewire in the correct order as the <code class=
            "systemitem">root</code> user:
          </p>
          <pre class="root"><kbd class=
          "command">cat &gt; /usr/bin/pipewire-launcher.sh &lt;&lt; "EOF"
<code class="literal">#!/bin/sh
# Begin /usr/bin/pipewire-launcher.sh

# First, kill any previous instances of pipewire, wireplumber, or pipewire-pulse
# that are running. Multiple instances of the daemon can not be run at the same
# time, and this helps prevent possible errors if a user logs out or logs in
# too fast, and restores audio if Pipewire hangs and needs to be reset.

pkill -u ${USER} -fx /usr/bin/pipewire-pulse
pkill -u ${USER} -fx /usr/bin/wireplumber
pkill -u ${USER} -fx /usr/bin/pipewire

# Start Pipewire first.
exec /usr/bin/pipewire &amp;

# Next, we need to wait until pipewire is up before starting wireplumber.
# This prevents a possible race condition where pipewire takes too long
# to start, as some users have run into.
while [ $(pgrep -f /usr/bin/pipewire) = "" ]; do
   sleep 1
done

# Start Wireplumber now that Pipewire has been started.
exec /usr/bin/wireplumber &amp;

# Start the Pulseaudio server included with Pipewire.
exec /usr/bin/pipewire-pulse &amp;

# End /usr/bin/pipewire-launcher.sh</code>
EOF</kbd></pre>
          <p>
            Next, make this shell script executable as the <code class=
            "systemitem">root</code> user:
          </p>
          <pre class="root"><kbd class=
          "command">chmod +x /usr/bin/pipewire-launcher.sh</kbd></pre>
          <p>
            Finally, create an XDG Autostart file that will run <span class=
            "command"><strong>/usr/bin/pipewire-launcher.sh</strong></span>
            when a desktop environment is started, as the <code class=
            "systemitem">root</code> user:
          </p>
          <pre class="root"><kbd class=
          "command">cat &gt; /etc/xdg/autostart/pipewire.desktop &lt;&lt; "EOF"
<code class="literal">[Desktop Entry]
Version=1.0
Name=Pipewire
Comment=Starts the Pipewire and Wireplumber daemons
Exec=/usr/bin/pipewire-launcher.sh
Terminal=false
Type=Application</code>
EOF</kbd></pre>
          <p>
            Now that Wireplumber is configured to start when a desktop
            environment is started, it is recommended that you log out of
            your session and log back in again.
          </p>
        </div>
      </div>
      <div class="content" lang="en" xml:lang="en">
        <h2 class="sect2">
          Contents
        </h2>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong class="segtitle">Installed Programs:</strong>
              <span class="segbody">wireplumber, wpctl, and wpexec</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Installed Libraries:</strong>
              <span class="segbody">libwireplumber-0.5.so</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Installed Directories:</strong>
              <span class="segbody">/usr/include/wireplumber-0.5,
              /usr/lib/wireplumber-0.5, /usr/share/wireplumber, and
              /usr/share/doc/wireplumber-0.5.10</span>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <h3>
            Short Descriptions
          </h3>
          <table border="0" class="variablelist">
            <colgroup>
              <col align="left" valign="top" />
              <col />
            </colgroup>
            <tbody>
              <tr>
                <td>
                  <p>
                    <a id="wireplumber-prog" name=
                    "wireplumber-prog"></a><span class="term"><span class=
                    "command"><strong>wireplumber</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    is a session and policy manager for Pipewire
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="wpctl" name="wpctl"></a><span class=
                    "term"><span class=
                    "command"><strong>wpctl</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    controls and queries information from Wireplumber
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="wpexec" name="wpexec"></a><span class=
                    "term"><span class=
                    "command"><strong>wpexec</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    executes Wireplumber scripts, which are often written in
                    Lua
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="libwireplumber" name=
                    "libwireplumber"></a><span class="term"><code class=
                    "filename">libwireplumber-0.5.so</code></span>
                  </p>
                </td>
                <td>
                  <p>
                    contains functions that allow other programs to control
                    Wireplumber
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="v4l-utils.html" title=
          "v4l-utils-1.30.1">Prev</a>
          <p>
            v4l-utils-1.30.1
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="x264.html" title="x264-20250815">Next</a>
          <p>
            x264-20250815
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="libdriv.html" title=
          "Chapter&nbsp;42.&nbsp;Multimedia Libraries and Drivers">Up</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Beyond Linux® From Scratch    (System V Edition) - Version 12.4">Home</a>
        </li>
      </ul>
    </div>
  </body>
</html>
